<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    
    <script>
        // Se ejecuta antes de cargar el body para evitar el flash blanco
        const savedTheme = localStorage.getItem('f1-theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
    </script><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparador Head-to-Head - F1</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .comparison-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px; }
        .pilot-card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); text-align: center; border-top: 5px solid #e10600; }
        .stat-row { margin: 10px 0; padding: 12px; background: #f9f9f9; border-radius: 4px; display: flex; justify-content: space-between; align-items: center; }
        .winner { background-color: #e8f5e9; border-left: 4px solid #4caf50; font-weight: bold; }
        .stat-label { font-size: 0.85em; color: #666; }
        .year-selector { text-align: center; margin-bottom: 20px; background: #f1f1f1; padding: 15px; border-radius: 8px; }
        select { padding: 10px; border-radius: 5px; width: 45%; font-family: 'Arial'; }
        .escuderia-text { color: #e10600; font-weight: bold; text-transform: uppercase; font-size: 0.85em; margin: 5px 0 15px 0; }
        hr { border: 0; border-top: 1px solid #eee; margin: 15px 0; }
    </style>
</head>
<body>
    <header>
        <h1>F1 RACING Stats</h1>
        <nav>
            <ul>
                <li><a href="index.html">Inicio</a></li>
                <li><a href="clasificacion-pilotos-anual.html">Clasificaci贸n Anual</a></li>
                <li><a href="Head-to-Head.html">Head-to-Head</a></li>
                <li><a href="clasificacion-historica.html">Pilotos Hist贸ricos</a></li>
                <li><a href="clasificacion-constructores.html">Constructores Hist贸ricos</a></li>
                <li><a href="records-f1.html">R茅cords</a></li>
                <li><a href="circuitos.html">Circuitos</a></li>
            </ul>
        </nav>
    </header>
    <button class="theme-switch" onclick="toggleTheme()"> Cambiar Modo</button>

    <script>
        function toggleTheme() {
            const doc = document.documentElement;
            const currentTheme = doc.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            // Aplicar el tema
            doc.setAttribute('data-theme', newTheme);
            
            // Guardar la elecci贸n para todas las p谩ginas
            localStorage.setItem('f1-theme', newTheme);
        }
    </script>

    <div class="container">
        <h2 style="text-align: center;">锔 COMPARADOR: HEAD-TO-HEAD</h2>
        
        <div class="year-selector">
            <label><strong>Modo de comparaci贸n:</strong></label><br>
            <select id="year-select" onchange="updatePilotLists()" style="width: 80%; margin-top: 10px;">
                <option value="HISTORICO"> MODO HISTRICO (Trayectoria Completa)</option>
            </select>
        </div>

        <div style="display: flex; justify-content: space-between; gap: 10px;">
            <select id="pilot1-select" onchange="compare()"></select>
            <select id="pilot2-select" onchange="compare()"></select>
        </div>

        <div class="comparison-container" id="comparison-results">
            <p style="grid-column: span 2; text-align: center; color: #888;">Elige dos pilotos para empezar el duelo.</p>
        </div>
    </div>

    <script src="data.js"></script>
    <script>
        // Adaptaci贸n autom谩tica al nombre de tu variable de datos
        const dataKey = typeof CLASIFICACION_PILOTOS !== 'undefined' ? CLASIFICACION_PILOTOS : (typeof f1_data !== 'undefined' ? f1_data : {});

        // Cargar a帽os al selector
        const yearSelect = document.getElementById('year-select');
        Object.keys(dataKey).reverse().forEach(year => {
            if(year !== "HISTORICO") {
                yearSelect.add(new Option(`Temporada ${year}`, year));
            }
        });

        function updatePilotLists() {
            const mode = yearSelect.value;
            const p1Sel = document.getElementById('pilot1-select');
            const p2Sel = document.getElementById('pilot2-select');
            p1Sel.innerHTML = '<option value="">Seleccionar Piloto 1</option>';
            p2Sel.innerHTML = '<option value="">Seleccionar Piloto 2</option>';

            if (mode === "HISTORICO") {
                Object.keys(PILOTOS_HISTORICOS).forEach(pName => {
                    p1Sel.add(new Option(pName, pName));
                    p2Sel.add(new Option(pName, pName));
                });
            } else {
                dataKey[mode].forEach(p => {
                    p1Sel.add(new Option(p.piloto, p.piloto));
                    p2Sel.add(new Option(p.piloto, p.piloto));
                });
            }
            document.getElementById('comparison-results').innerHTML = '<p style="grid-column: span 2; text-align: center; color: #888;">Elige dos pilotos para empezar el duelo.</p>';
        }

        function getFullData(name, mode) {
            if (mode === "HISTORICO") {
                const hData = PILOTOS_HISTORICOS[name];
                return { 
                    nombre: name, 
                    titulos: hData.titulos || 0, 
                    victorias: hData.victorias || 0,
                    poles: hData.poles || 0,
                    puntos: hData.puntos || 0,
                    tipo: 'HISTORICO' 
                };
            } else {
                const pYear = dataKey[mode].find(p => p.piloto === name);
                return { 
                    nombre: name, 
                    pos: pYear.pos, 
                    puntos: pYear.puntos, 
                    escuderia: pYear.escuderia, 
                    nacionalidad: pYear.nacionalidad,
                    tipo: 'ANUAL'
                };
            }
        }

        function compare() {
            const mode = yearSelect.value;
            const name1 = document.getElementById('pilot1-select').value;
            const name2 = document.getElementById('pilot2-select').value;
            if (!name1 || !name2) return;

            const p1 = getFullData(name1, mode);
            const p2 = getFullData(name2, mode);

            document.getElementById('comparison-results').innerHTML = `
                ${renderCard(p1, p2, mode)}
                ${renderCard(p2, p1, mode)}
            `;
        }

        function renderCard(p, r, mode) {
            if (p.tipo === 'ANUAL') {
                return `
                    <div class="pilot-card">
                        <h3 style="color:#e10600; margin-bottom:0;">${p.nombre}</h3>
                        <p class="escuderia-text">${p.escuderia}</p>
                        <p style="font-weight:bold; color:#555; font-size:0.8em; margin-bottom:10px;">TEMPORADA ${mode}</p>
                        <div class="stat-row ${p.pos < r.pos ? 'winner' : ''}">
                            <span class="stat-label"> Posici贸n Final</span>
                            <span>${p.pos}潞</span>
                        </div>
                        <div class="stat-row ${p.puntos > r.puntos ? 'winner' : ''}">
                            <span class="stat-label"> Puntos</span>
                            <span>${p.puntos}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label"> Nacionalidad</span>
                            <span>${p.nacionalidad}</span>
                        </div>
                    </div>
                `;
            } else {
                return `
                    <div class="pilot-card">
                        <h3 style="color:#e10600; margin-bottom:0;">${p.nombre}</h3>
                        <p class="escuderia-text">Leyenda de la F1</p>
                        <p style="font-weight:bold; color:#555; font-size:0.8em; margin-bottom:10px;">DATOS HISTRICOS</p>
                        <div class="stat-row ${p.titulos > r.titulos ? 'winner' : ''}">
                            <span class="stat-label"> Mundiales</span>
                            <span>${p.titulos}</span>
                        </div>
                        <div class="stat-row ${p.victorias > r.victorias ? 'winner' : ''}">
                            <span class="stat-label"> Victorias</span>
                            <span>${p.victorias}</span>
                        </div>
                        <div class="stat-row ${p.poles > r.poles ? 'winner' : ''}">
                            <span class="stat-label">憋 Poles</span>
                            <span>${p.poles}</span>
                        </div>
                        <div class="stat-row ${p.puntos > r.puntos ? 'winner' : ''}">
                            <span class="stat-label"> Puntos Totales</span>
                            <span>${p.puntos}</span>
                        </div>
                    </div>
                `;
            }
        }

        updatePilotLists();
    </script>
</body>
</html>